// SPDX-License-Identifier: MIT
pragma solidity ^0.8.20;

import "forge-std/Test.sol";
import "../src/VulnerableContract.sol";

contract DataLeakExploitTest is Test {
    VulnerableContract vulnerable;

    function setUp() public {
        vulnerable = new VulnerableContract();
    }

    function test__UnencryptedDataLeak() public {
        vulnerable.register("Alice", "supersecret123");

        (string memory username, string memory password) = vulnerable.users(address(this));

        console.log("Extracted Username:", username);
        console.log("Extracted Password:", password);

        assertEq(username, "Alice");
        assertEq(password, "supersecret123"); // ⚠️ Password is exposed publicly
    }
}
